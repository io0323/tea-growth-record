# This is the main configuration file for the application.
# https://www.playframework.com/documentation/latest/ConfigFile

play {
  # Secret key
  # --------
  # The secret key is used to sign Play session cookies and CSRF tokens.
  # This must be changed for production, but we don't recommend you change it in this file.
  secret.key = "changeme"

  # The application languages
  # --------
  i18n.langs = ["ja"]

  # Whether to bind to 0.0.0.0, allowing the application to be accessed from other machines.
  # --------
  server.http.address = "0.0.0.0"

  # The port to bind to.
  # --------
  server.http.port = 9000

  # The base URL of the application.
  # --------
  application.context = "/"

  # セッション設定
  http.session {
    cookieName = "PLAY_SESSION"
    maxAge = 7d
    secure = false
    httpOnly = true
    sameSite = "lax"
  }
  
  # CSRF設定
  http.filters {
    csrf {
      cookie.name = "Csrf-Token"
      header.name = "Csrf-Token"
      token.name = "csrfToken"
    }
  }
  
  # CORS設定
  filters {
    enabled = ["play.filters.cors.CORSFilter"]
    cors {
      allowedOrigins = ["http://localhost:5173"]
      allowedHttpMethods = ["GET", "POST", "PUT", "DELETE", "OPTIONS"]
      allowedHttpHeaders = ["Accept", "Content-Type", "Origin", "X-CSRF-Token", "X-XSRF-TOKEN"]
      preflightMaxAge = 3 days
      supportsCredentials = true
      exposedHeaders = ["X-CSRF-Token"]
    }
  }

  # メーラー設定（開発環境用）
  mailer {
    mock = true
    host = "localhost"
    port = 25
    ssl = no
    tls = no
    user = ""
    password = ""
    from = "noreply@localhost"
  }

  # ログ設定
  logger {
    play = INFO
    root = INFO
  }

  # Akka設定
  akka {
    http {
      server {
        idle-timeout = 60s
      }
    }
    actor {
      default-dispatcher {
        fork-join-executor {
          parallelism-min = 8
          parallelism-max = 64
          parallelism-factor = 3.0
        }
      }
    }
    log-dead-letters = off
    log-dead-letters-during-shutdown = off
  }
}

# Database configuration
# --------
slick.dbs.default {
  profile = "slick.jdbc.MySQLProfile$"
  db {
    driver = "com.mysql.cj.jdbc.Driver"
    url = "jdbc:mysql://localhost:3306/tea_growth_record?useSSL=false&serverTimezone=UTC"
    user = "root"
    password = ""
    numThreads = 10
    connectionTimeout = 10000
    validationTimeout = 10000
    idleTimeout = 10000
    maxLifetime = 1000000
  }
}

# Evolutions
# --------
play.evolutions {
  enabled = true
  autoApply = true
  autoApplyDowns = true
}

# Logger
# --------
logger.application = DEBUG

# Application specific configuration
app {
  baseUrl = "http://localhost:9000"
  uploadDir = "uploads"
  name = "tea-growth-record"
  version = "1.0-SNAPSHOT"
} 